{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/1010/","result":{"data":{"site":{"siteMetadata":{"title":"Dev.log","siteUrl":"https://wwan13.github.io","thumbnail":"/thumbnails/tech-blog-thumbnail.png"}},"markdownRemark":{"id":"b0575dd2-cdbb-50b2-a39c-b74eb97bc129","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%B2%AB-%EB%B2%88%EC%A7%B8-%EB%B0%A9%EB%B2%95--%EB%AA%A8%EB%93%A0-%EC%97%90%EB%9F%AC-%EC%BD%94%EB%93%9C%EB%A5%BC-%EB%8B%B4%EC%9D%80-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0\">첫 번째 방법 : 모든 에러 코드를 담은 컨트롤러 추가하기</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%91%90-%EB%B2%88%EC%A7%B8-%EB%B0%A9%EB%B2%95--%EC%98%88%EC%99%B8-exampleschema%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0\">두 번째 방법 : 예외 Example(Schema)추가하기</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%A7%80%EB%A7%89-%EB%B0%A9%EB%B2%95--description%EC%9D%98-markdown%EB%AC%B8%EB%B2%95-%EC%A7%80%EC%9B%90-%ED%99%9C%EC%9A%A9\">마지막 방법 : Description의 Markdown문법 지원 활용</a></p>\n<ul>\n<li><a href=\"#%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0\">구현하기</a></li>\n</ul>\n</li>\n</ul>","excerpt":"API documentation is a technical content deliverable, containing instructions about how to effectively use and integrate with an API. swagger 에서는 API 문서를\n‘API…","html":"<blockquote>\n<p>API documentation is a technical content deliverable, containing instructions about how to effectively use and integrate with an API.</p>\n</blockquote>\n<br/>\n<p><a href=\"https://swagger.io/blog/api-documentation/what-is-api-documentation-and-why-it-matters/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">swagger</a> 에서는 API 문서를\n‘API를 효과적으로 사용하고 통합하는 방법에 대한 지침을 포함하는 기술 콘텐츠’로 API의 정보, 반환값, 요청값 등을 포함하고 있는 것으로 소개하고 있습니다.</p>\n<p>하지만 이것들 만으로는 ‘API를 사용하며 발생할 수 있는 여러 <strong>예외 상황에 대한 지침</strong>‘은 제공할 수 없습니다.</p>\n<p>서버에서 발생하는 여러 예외에 대한 분기를 클라이언트가 처리하기 위해 <code class=\"language-text\">Error Code</code>를 반환하는 방법을 사용하곤 합니다.\n이번 포스팅에서는 제가 OAS3를 사용하는 API문서에 에러 코드를 추가한 방법에 대해 공유해 보겠습니다.</p>\n<p><em>해당 포스팅은 <a href=\"https://wwan13.github.io/1009/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이전 포스팅</a>에서 제작한 <code class=\"language-text\">kotlin-dsl-rest-docs</code>를 개선한 것으로 위 포스팅 혹은 <a href=\"https://github.com/wwan13/kotlin-dsl-rest-docs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">깃허브 저장소</a>를 참고하여 주세요.</em></p>\n<p><br/><br/></p>\n<h2 id=\"첫-번째-방법--모든-에러-코드를-담은-컨트롤러-추가하기\" style=\"position:relative;\">첫 번째 방법 : 모든 에러 코드를 담은 컨트롤러 추가하기<a href=\"#%EC%B2%AB-%EB%B2%88%EC%A7%B8-%EB%B0%A9%EB%B2%95--%EB%AA%A8%EB%93%A0-%EC%97%90%EB%9F%AC-%EC%BD%94%EB%93%9C%EB%A5%BC-%EB%8B%B4%EC%9D%80-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0\" aria-label=\"첫 번째 방법  모든 에러 코드를 담은 컨트롤러 추가하기 permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>처음 알게 된 방법은 모든 에러 코드를 반환하는 컨트롤러를 테스트 코드에 추가하는 방법입니다.<br>\n<em>(직접 시도한 방법이 아니기 때문에 자세한 설명은 생략하겠습니다. <a href=\"https://0soo.tistory.com/210\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">참고</a>)</em></p>\n<p><code class=\"language-text\">ENUM.entries()</code> 를 그대로 호출하기에 실수로 누락할 일도 없고, 한 눈에 모든 에러 코드를 확인할 수 있다는 장점이 있습니다.</p>\n<p>하지만 저는 <strong>API별 호출시 발생 가능한 에러 코드들의 모음</strong>을 원했기 때문에, 모든 API에 대한 에러 코드의 모음인 이 방법은 적절하지 못했습니다.</p>\n<p><br/><br/></p>\n<h2 id=\"두-번째-방법--예외-exampleschema추가하기\" style=\"position:relative;\">두 번째 방법 : 예외 Example(Schema)추가하기<a href=\"#%EB%91%90-%EB%B2%88%EC%A7%B8-%EB%B0%A9%EB%B2%95--%EC%98%88%EC%99%B8-exampleschema%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0\" aria-label=\"두 번째 방법  예외 exampleschema추가하기 permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>두 번째 방법은 정상적인 API에 대한 문서를 제공하는 것과 동일한 방법으로 에외 케이스에 대한 테스트 코드를 작성하는 것입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Test</span>\n<span class=\"token keyword\">fun</span> <span class=\"token function\">`사용자 회원 가입 API error USER_ALREADY_EXISTS`</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    every <span class=\"token punctuation\">{</span> userService<span class=\"token punctuation\">.</span><span class=\"token function\">appendUser</span><span class=\"token punctuation\">(</span><span class=\"token function\">any</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">any</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span> throws <span class=\"token function\">CoreException</span><span class=\"token punctuation\">(</span>ErrorType<span class=\"token punctuation\">.</span>USER_ALREADY_EXISTS<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">val</span> api <span class=\"token operator\">=</span> api<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"/api/v1/user\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">requestBody</span><span class=\"token punctuation\">(</span><span class=\"token function\">UserAppendRequest</span><span class=\"token punctuation\">(</span><span class=\"token operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">documentFor</span><span class=\"token punctuation\">(</span>api<span class=\"token punctuation\">,</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"user-sign-up-error(USER_ALREADY_EXISTS)\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">summary</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"사용자 회원 가입 API error USER_ALREADY_EXISTS\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">requestFields</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"email\"</span></span> isTypeOf STRING whichMeans <span class=\"token string-literal singleline\"><span class=\"token string\">\"이메일\"</span></span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"nickname\"</span></span> isTypeOf STRING whichMeans <span class=\"token string-literal singleline\"><span class=\"token string\">\"닉네임\"</span></span><span class=\"token punctuation\">,</span>\n            <span class=\"token operator\">..</span><span class=\"token punctuation\">.</span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token function\">responseFields</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"data.errorCode\"</span></span> isTypeOf STRING whichMeans <span class=\"token string-literal singleline\"><span class=\"token string\">\"발생한 에러 코드\"</span></span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"data.errorMessage\"</span></span> isTypeOf STRING whichMeans <span class=\"token string-literal singleline\"><span class=\"token string\">\"발생한 에러 메세지\"</span></span>\n        <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>기존 테스트코드에 위와 같이 예외 상황을 포함하는 새로운 테스트케이스를 추가한 뒤 문서를 생성하면 다음과 같은 결과를 얻을 수 있습니다.</p>\n<br/>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8f5563f84a52a20c9ec0055d43befa37/0940f/image1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.55696202531645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkElEQVR42p2T63KkIBCFfZ2M4A0vIAKKo87ErcpW3v9dThqcH5NJdjOVH5/YFnU4nG6T5brDbxd0g0Vvx1+jjIMkErUuqCcHva3Ihx7ZHY/1v+BakcaI7jwjqf0YCzE6sF7RBn1gejCtnhYUo0UzT0hYL1H6Af59R7uOOCkBblpMrzuUn8G7DrlST4kGEq77KOjeNqirR2Yl2NCiJJdFcBpcB/QP3IST8ChI1E0LGqORNy3SrMIpL5EW1dNwJWNMCQ/KVEzzgk4PqPoOgmLIKoETI9HsAf49XHaHQ0EdLq2JJ7Dw8XbFVJLT7ithD5fyE4xyrpxB7aeQoUJDXbbXK4RzcUOhNcyFZtN7yHmOHO8ewlpyouL17slDXEQUFM5i2v/AbFvsaE4OFc1Ufz7fWKDmo65JkP9nnChDhcpQl88rpHcoyP6JQn4pSlrLuN6TlgKs+kpsSuwy2UzbBvv+hnV/hf07Y7jQ1XPqHiso8AfY94R5jV2OvxiNjVAapVQowqBrCrtp6OQaTDwH74+x+QCaTKoTDf8v7AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image1\"\n        title=\"image1\"\n        src=\"/static/8f5563f84a52a20c9ec0055d43befa37/f058b/image1.png\"\n        srcset=\"/static/8f5563f84a52a20c9ec0055d43befa37/c26ae/image1.png 158w,\n/static/8f5563f84a52a20c9ec0055d43befa37/6bdcf/image1.png 315w,\n/static/8f5563f84a52a20c9ec0055d43befa37/f058b/image1.png 630w,\n/static/8f5563f84a52a20c9ec0055d43befa37/40601/image1.png 945w,\n/static/8f5563f84a52a20c9ec0055d43befa37/0940f/image1.png 1154w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>200을 반환하는 정상적인 반환값 아래, 400의 예외 상황을 반환하는 필드가 추가된 것을 확인할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/24883eff4053f35722ce0e5b6573651c/47aef/image2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.0126582278481%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABG0lEQVR42o2RW0/CQBSE+S0+ULTbbrvbCy3dbRELVgnxRlQuvkiiqYBE4+8fT1sS4+XBh29ncpKdM5ttyUxDVPQ1zLgLW8U1lTdCryFo6IQN1czqRbCT+BctRhdFqpBPJlCjEZyIwnwf59NbzB5XuJzNcbN8wPViiav5ovYX93PILP0ztFUNRaqRFgWS4RCe1jikwOnsDh/vO7xuSuy2a9IXvO22WJdPKJ9XiPNB/Qr+M7A6OIXqQY6on0GQZ66EwTgMi6NN2rGc2hukbZPjoGPiiLtgjvyCS1heQIGqBxYGOMkLjM7GiE9TqHEfThDAZA6Y7cK09uy9xQWp8x1azKRsGtrUqqtShEpD6hj+cQKRUFPh/R+XPsoP8AnvZ8oB9GsCGAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image1\"\n        title=\"image1\"\n        src=\"/static/24883eff4053f35722ce0e5b6573651c/f058b/image2.png\"\n        srcset=\"/static/24883eff4053f35722ce0e5b6573651c/c26ae/image2.png 158w,\n/static/24883eff4053f35722ce0e5b6573651c/6bdcf/image2.png 315w,\n/static/24883eff4053f35722ce0e5b6573651c/f058b/image2.png 630w,\n/static/24883eff4053f35722ce0e5b6573651c/40601/image2.png 945w,\n/static/24883eff4053f35722ce0e5b6573651c/47aef/image2.png 1063w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>발생하는 예외가 여러 개인 경우 위와 같이 드롭다운을 통해 확인도 가능합니다.</p>\n<br/>\n<p>하지만 이 방법에는 치명적인 단점이 존재하였습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9a721e29815b631cf287c4223c0c32b1/b5cea/invalid_examples.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.0126582278481%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtElEQVR42p3OzRKCIBQFYF6n/AVTwFRUKtQcJ+v9n+Wk6LRwUWOLb7gw3DOHmH5A3bRIshw8Lz5EoSBVac3z1vwnq/W026G8NSivxmYQM47oni8UZnpsW6immbRItYaXJAikhJ+nX5wRrOY7Ebq2y4lSdjlMU2uePc4XQvzAF1KA5PUF9/GBbKhAJYfjUxy90J67eBQujUCySsP0PeJyqs+i/UHbwDBeWh2ctVXA/uMzuOyEN6zuw1fIGjggAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"invalid_examples\"\n        title=\"invalid_examples\"\n        src=\"/static/9a721e29815b631cf287c4223c0c32b1/f058b/invalid_examples.png\"\n        srcset=\"/static/9a721e29815b631cf287c4223c0c32b1/c26ae/invalid_examples.png 158w,\n/static/9a721e29815b631cf287c4223c0c32b1/6bdcf/invalid_examples.png 315w,\n/static/9a721e29815b631cf287c4223c0c32b1/f058b/invalid_examples.png 630w,\n/static/9a721e29815b631cf287c4223c0c32b1/40601/invalid_examples.png 945w,\n/static/9a721e29815b631cf287c4223c0c32b1/b5cea/invalid_examples.png 1140w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Examples의 알 수 없는 정렬 조건으로 간혹 위와 같이 에러 케이스가 대표 예제로 설정되는 것이었습니다.<br>\n테스트 순서 조정, 에러 케이스의 앞에 특수문자 삽입 등 여러 방법을 시도해 보았으나 그 순서는 변하지 않았습니다.</p>\n<p>사소한 문제로 넘어갈 수 있었지만, 프론트앤드 개발자가 잘못된 예제를 옳은 예제로 혼동할 가능성이 있다고 판단하여 이 방법도 사용하지 않기로 하였습니다.</p>\n<p><br/><br/></p>\n<h2 id=\"마지막-방법--description의-markdown문법-지원-활용\" style=\"position:relative;\">마지막 방법 : Description의 Markdown문법 지원 활용<a href=\"#%EB%A7%88%EC%A7%80%EB%A7%89-%EB%B0%A9%EB%B2%95--description%EC%9D%98-markdown%EB%AC%B8%EB%B2%95-%EC%A7%80%EC%9B%90-%ED%99%9C%EC%9A%A9\" aria-label=\"마지막 방법  description의 markdown문법 지원 활용 permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>OAS3에는 API에 대한 자세한 설명을 더하기 위해 다음과 같은 Description 필드가 존재합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a65212811a3870d1a3e4c1e7067aad82/1d69c/description_example.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.455696202531648%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAc0lEQVR42o3MSw7CIACEYe5/AG/hJdy6dmOqlRgptEWKlD5i6K/iBVh8mcwsRuxPG7sjHC4rUlkq5TnfLXXzQpqAcgt2gj5uRcTDvbnqgGzHfFA3ntuvm78uJGykmOjHRDssdH7NtJtymu+m3cwzJoaZYh+sG+T6LsAAJAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"description_example\"\n        title=\"description_example\"\n        src=\"/static/a65212811a3870d1a3e4c1e7067aad82/f058b/description_example.png\"\n        srcset=\"/static/a65212811a3870d1a3e4c1e7067aad82/c26ae/description_example.png 158w,\n/static/a65212811a3870d1a3e4c1e7067aad82/6bdcf/description_example.png 315w,\n/static/a65212811a3870d1a3e4c1e7067aad82/f058b/description_example.png 630w,\n/static/a65212811a3870d1a3e4c1e7067aad82/1d69c/description_example.png 750w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<br/>\n<p>단순 텍스트만 입력 가능한 줄 알았으나 놀랍게도 이 Description 필드에서 html과 markdown 를 모두 지원하고 있었습니다.<br>\n따라서 저는 이 필드와 마크다운을 이용해 에러 코드를 추가해 보자 하였습니다.</p>\n<br/>\n<h3 id=\"구현하기\" style=\"position:relative;\">구현하기<a href=\"#%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0\" aria-label=\"구현하기 permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>우선 문서화 대상인 에러코드와 에러메세지를 담은 클래스 생성 뒤 kotlin-dsl-rest-docs의 컨셉에 맞게 infix 함수도 추가해 줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">infix</span> <span class=\"token keyword\">fun</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">provideMessage</span><span class=\"token punctuation\">(</span>message<span class=\"token operator\">:</span> String<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> DocumentError <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">DocumentError</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// EXAMPLE_ERROR_CODE provideMessage \"예시 에러 코드 입니다.\"</span>\n\n<span class=\"token keyword\">data</span> <span class=\"token keyword\">class</span> <span class=\"token function\">DocumentError</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">val</span> code<span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">val</span> message<span class=\"token operator\">:</span> String\n<span class=\"token punctuation\">)</span></code></pre></div>\n<br/>\n<p>선언한 에러코드들을 Desciption에서 사용할 수 있도록 MarkdonConverter라는 유틸 함수를 작성해 줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">object</span> MarkdownConverter <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">fun</span> <span class=\"token function\">convertErrors</span><span class=\"token punctuation\">(</span>errors<span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>DocumentError<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> String <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"\"</span></span>\"\n            |\n            |### Error Codes\n            |\n            |<span class=\"token operator\">&lt;</span>details<span class=\"token operator\">></span>\n            |<span class=\"token operator\">&lt;</span>summary<span class=\"token operator\">></span> more <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>summary<span class=\"token operator\">></span>\n            |\n            <span class=\"token operator\">||</span>ErrorCode|ErrorMessage|\n            <span class=\"token operator\">||</span><span class=\"token operator\">:</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span>|<span class=\"token operator\">:</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span>|\n            |$<span class=\"token punctuation\">{</span>errors<span class=\"token punctuation\">.</span><span class=\"token function\">joinToString</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"\\n\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"|</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token expression\">it<span class=\"token punctuation\">.</span>code</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">|</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token expression\">it<span class=\"token punctuation\">.</span>message</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">|\"</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n            |\n            |<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>details<span class=\"token operator\">></span>\n            |\n        <span class=\"token string-literal singleline\"><span class=\"token string\">\"\"</span></span>\"<span class=\"token punctuation\">.</span><span class=\"token function\">trimMargin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">fun</span> <span class=\"token function\">join</span><span class=\"token punctuation\">(</span>values<span class=\"token operator\">:</span> List<span class=\"token operator\">&lt;</span>String<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> String <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> values<span class=\"token punctuation\">.</span><span class=\"token function\">joinToString</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"&lt;br/>\"</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<br/>\n<p>기존 <code class=\"language-text\">summary.description</code>만 존재하던 필드에 마크다운으로 변환된 에러 코드를 추가해 줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token comment\">// ApiDocumentContext</span>\n<span class=\"token keyword\">val</span> description<span class=\"token operator\">:</span> String\n    <span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">val</span> elements <span class=\"token operator\">=</span> mutableListOf<span class=\"token operator\">&lt;</span>String<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>summary<span class=\"token punctuation\">.</span><span class=\"token function\">hasDescription</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> elements<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>summary<span class=\"token punctuation\">.</span>description<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>errors<span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> elements<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>MarkdownConverter<span class=\"token punctuation\">.</span><span class=\"token function\">convertErrors</span><span class=\"token punctuation\">(</span>errors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> MarkdownConverter<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>elements<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p>나아가 API에 포함된 ENUM을 담은 <code class=\"language-text\">DocumentEnum</code>과, API 설명을 ul의 형식으로 할 수 있도록 <code class=\"language-text\">DocumentGuide</code>도 추가하였습니다.</p>\n<br/>\n<p>그 결과 다음과 같이 테스트를 작성하면 필요했던 모든 정보를 담은 풍족한 API 문서가 생성되는 것을 볼 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Test</span>\n<span class=\"token keyword\">fun</span> <span class=\"token function\">`사용자 회원 가입 API`</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ..</span>\n\n    <span class=\"token function\">documentFor</span><span class=\"token punctuation\">(</span>api<span class=\"token punctuation\">,</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"user-sign-up\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">summary</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"사용자 회원 가입 API\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">guide</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"사전에 호출한 oauth2 기본 프로필 조회 결과를 담아 회원가입 API를 호출해 주세요.\"</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token function\">containedEnums</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"platform\"</span></span> hasValues OauthPlatform<span class=\"token punctuation\">.</span>entries<span class=\"token punctuation\">.</span><span class=\"token function\">map</span> <span class=\"token punctuation\">{</span> it<span class=\"token punctuation\">.</span>value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"gender\"</span></span> hasValues Gender<span class=\"token punctuation\">.</span>entries<span class=\"token punctuation\">.</span><span class=\"token function\">map</span> <span class=\"token punctuation\">{</span> it<span class=\"token punctuation\">.</span>value <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token function\">expectedError</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"USER_400_0\"</span></span> providesMessage <span class=\"token string-literal singleline\"><span class=\"token string\">\"이미 사용중인 닉네임 입니다.\"</span></span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"USER_400_1\"</span></span> providesMessage <span class=\"token string-literal singleline\"><span class=\"token string\">\"유효하지 않은 닉네임 입니다.\"</span></span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"USER_400_2\"</span></span> providesMessage <span class=\"token string-literal singleline\"><span class=\"token string\">\"이미 등록된 유저입니다.\"</span></span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"CORE_DOMAIN_400_2\"</span></span> providesMessage <span class=\"token string-literal singleline\"><span class=\"token string\">\"유효하지 않은 enum value 입니다\"</span></span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token function\">requestFields</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"platform\"</span></span> isTypeOf <span class=\"token function\">ENUM</span><span class=\"token punctuation\">(</span>OauthPlatform<span class=\"token operator\">::</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> whichMeans <span class=\"token string-literal singleline\"><span class=\"token string\">\"oauth2 플랫폼 (naver/google)\"</span></span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"email\"</span></span> isTypeOf STRING whichMeans <span class=\"token string-literal singleline\"><span class=\"token string\">\"이메일\"</span></span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"gender\"</span></span> isTypeOf <span class=\"token function\">ENUM</span><span class=\"token punctuation\">(</span>Gender<span class=\"token operator\">::</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> whichMeans <span class=\"token string-literal singleline\"><span class=\"token string\">\"성별 (남성/여성)\"</span></span><span class=\"token punctuation\">,</span>\n            <span class=\"token comment\">// ...</span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token function\">responseFields</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string-literal singleline\"><span class=\"token string\">\"data.id\"</span></span> isTypeOf NUMBER whichMeans <span class=\"token string-literal singleline\"><span class=\"token string\">\"생성된 유저의 ID\"</span></span>\n        <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/aef3bc1db4f5a60566aeeb4a2aa801da/147d8/result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.93670886075949%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6UlEQVR42p2Sy27CMBBF8/9/1XU3XVSoBdEEguPEjzix4zwA6eJx1EVYQGBxZXtmdDxz7eRD/eJT7HEyEsdW4uQ0qtEGtRBhXSveG+jBIimNRiZKVOFQ+gZlZ1BYDTk41Ge/WjrIXUck1BkLgBicuqh68i/BZmAHexmQsEYhD9DmOsyws39LBHQEFDSmMzCX/m3YAli0GvwBUI1kg48TrAJmskAqigj895CkRhdjmeT4yf9wUHyRv5ea3Ozhnuf4TneQvV3eGIqoq1QwfG032LJDeHm7zsNjXcWvcl9EHdI3Yo2Medo/A94AvzqxFF2GgNwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result\"\n        title=\"result\"\n        src=\"/static/aef3bc1db4f5a60566aeeb4a2aa801da/f058b/result.png\"\n        srcset=\"/static/aef3bc1db4f5a60566aeeb4a2aa801da/c26ae/result.png 158w,\n/static/aef3bc1db4f5a60566aeeb4a2aa801da/6bdcf/result.png 315w,\n/static/aef3bc1db4f5a60566aeeb4a2aa801da/f058b/result.png 630w,\n/static/aef3bc1db4f5a60566aeeb4a2aa801da/40601/result.png 945w,\n/static/aef3bc1db4f5a60566aeeb4a2aa801da/78612/result.png 1260w,\n/static/aef3bc1db4f5a60566aeeb4a2aa801da/147d8/result.png 1465w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<br/>\n<hr/>\n<br/>\n<p><code class=\"language-text\">kotlin-dsl-rest-docs</code>의 모든 코드는 <a href=\"https://github.com/wwan13/kotlin-dsl-rest-docs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">깃허브 저장소</a>에서 확인할 수 있습니다.<br>\n<del>스타와, contribution은 언제나 환영입니다 ~!</del></p>\n<p><a href=\"https://github.com/Desk-Mood/deskmood-server/tree/main/deskmood-core/core-api/src/test/kotlin/org/deskmood/docs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">deskmood 저장소</a>에서 제가  <code class=\"language-text\">kotlin-dsl-rest-docs</code>를 어떻게 활용하고 있는지 확인하실 수 있습니다.</p>","fields":{"slug":"/1010/"},"frontmatter":{"title":"API 문서에 오류코드 추가하기.","date":"2024-09-29T00:00:00.000Z","description":"OAS3로 제작한 API 문서에 오류코드를 어떻게 추가할까요?","tags":["Tech"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#181838","images":{"fallback":{"src":"/static/32047d9c7f5fda5b294e65e3443a62d0/8058b/thumbnail.png","srcSet":"/static/32047d9c7f5fda5b294e65e3443a62d0/52057/thumbnail.png 240w,\n/static/32047d9c7f5fda5b294e65e3443a62d0/b380a/thumbnail.png 480w,\n/static/32047d9c7f5fda5b294e65e3443a62d0/8058b/thumbnail.png 960w","sizes":"(min-width: 960px) 960px, 100vw"},"sources":[{"srcSet":"/static/32047d9c7f5fda5b294e65e3443a62d0/226ed/thumbnail.webp 240w,\n/static/32047d9c7f5fda5b294e65e3443a62d0/a1501/thumbnail.webp 480w,\n/static/32047d9c7f5fda5b294e65e3443a62d0/55375/thumbnail.webp 960w","type":"image/webp","sizes":"(min-width: 960px) 960px, 100vw"}]},"width":960,"height":720}}}}},"previous":{"fields":{"slug":"/1009/"},"frontmatter":{"title":"kotlin의 dsl로 spring rest docs를 개선하는 방법."}},"next":null},"pageContext":{"id":"b0575dd2-cdbb-50b2-a39c-b74eb97bc129","previousPostId":"a2dcd3bf-b39d-543e-94ab-8635543a4969","nextPostId":null}},"staticQueryHashes":["2260143708","2538111481","658623446","984448874"],"slicesMap":{}}